@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<p>
    <div class="row">
        <div class="col-2">
            <select id="ChartType" @ViewBag.ChartType="id" class="form-select form-select-sm" aria-label=".form-select-sm example">
                <option selected>--- Select Chart Type ---</option>
                <option value="bar">Bar</option>
                <option value="pie">Pie</option>
                <option value="doughnut">Doughnut</option>
            </select>
        </div>
        <div class="col-2">
            <button id="ID" value="Show Graph" type="submit" class="btn btn-outline-primary rounded keychainify-checked">
                <i class="bi bi-brush"></i>
                Create chart
            </button>
        </div>
    </div>
</p>
<br />
<div id="ChartView">
    <canvas id="myChart"></canvas>
</div>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script type="text/javascript">

    $(function () {
        $("#ID").click(function () {
            if (ViewBag.ChartType != "--- Select Chart Type ---" || ViewBag.ChartType != null) {
                var chartType = $("#ChartType").val();
                var chartView = document.getElementById('ChartView');

                chartView.innerHTML = '&nbsp;';

                $('#ChartView').append('<canvas id="myChart" style="max-width:1400px; max-height:700px;"><canvas>');

                $.ajax({
                    type: "POST",
                    url: "/Statistics/IdeaDepartmentData",
                    data: "",
                    contextType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: OnSuccessResult,
                    error: OnError
                });
                function OnSuccessResult(data) {
                    console.log(data);
                    var _data = data;
                    var _chartLabels = _data[0];
                    var _chartData = _data[1];

                    new Chart("myChart",
                        {
                            type: chartType,
                            data: {
                                labels: _chartLabels,
                                datasets: [{
                                    data: _chartData
                                }]
                            }
                        });
                }
                function OnError(err) {
                    console.log("Fail.");
                }
            }
        });
    });

</script>

